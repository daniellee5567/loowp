!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function t(){this.$body=jQuery(document.body),this.init()}t.prototype={init:function(){var t=this;this.city_select_select2(),this.city_select_select2(1),jQuery("select.country_to_state, input.country_to_state").trigger("change");var e=wc_cities_select_params.cities.replace(/&quot;/g,'"'),n=JSON.parse(e);t.$body.on("country_to_state_changing",(function(e,n,c){console.log("country_to_state_changing");var i,a=wc_address_i18n_params.locale.replace(/&quot;/g,'"'),o=JSON.parse(a),r=c;i=void 0!==o[n]?o[n]:o.default;var s=JSON.parse(wc_address_i18n_params.locale_fields);jQuery.each(s,(function(t,e){var n=r.find(e),c=jQuery.extend(!0,{},o.default[t],i[t]);Array.isArray(c.label_class)&&n.find("label").length&&n.find("label").attr("class",c.label_class.join(" "))}));var l=c.find("#billing_state, #shipping_state, #calc_shipping_state").val();t.$body.trigger("state_changing",[n,l,c])})).on("change","select.state_select, #calc_shipping_state",(function(){console.log("change state");var e=jQuery(this).closest("div"),n=e.find("#billing_country, #shipping_country, #calc_shipping_country").val(),c=jQuery(this).val();t.$body.trigger("state_changing",[n,c,e])})).on("change","select.city_select, #calc_shipping_city",(function(){console.log("change city");var e=jQuery(this).closest("div"),n=e.find("#billing_country, #shipping_country, #calc_shipping_country").val(),c=e.find("#billing_state, #shipping_state, #calc_shipping_state").val(),i=jQuery(this).val();t.$body.trigger("city_changing",[n,c,i,e])})).on("state_changing",(function(e,c,i,a){var o=a.find("#billing_city, #shipping_city, #calc_shipping_city");n[c]?n[c]instanceof Array?t.cityToSelect(o,n[c]):i?n[c][i]?t.cityToSelect(o,n[c][i]):t.cityToInput(o):t.disableCity(o):t.cityToInput(o),console.log("state_changing",o,o.val()),t.$body.trigger("city_changing",[c,i,o.val(),a])})).on("city_changing",(function(e,c,i,a,o){var r=o.find("#billing_address_1, #shipping_address_1, #calc_shipping_address_1");n[c]&&n[c][i]?(n[c][i]instanceof Array?t.cityToSelect(r,n[c][i],1):i&&a?n[c][i][a]?t.cityToSelect(r,n[c][i][a],1):t.cityToInput(r):t.disableCity(r),console.log("city_changing",a)):n[c]?t.disableCity(r):t.cityToInput(r)})).on("city_to_select",(function(){console.log("city_to_select"),t.city_select_select2()})).on("district_to_select",(function(){console.log("district_to_select"),t.city_select_select2(1)}))},city_select_select2:function(t){if(jQuery().select2){var e=this;t=t?"district":"city",jQuery("select."+t+"_select:visible").each((function(){var t=jQuery.extend({placeholderOption:"first",width:"100%"},e.getEnhancedSelectFormatString());jQuery(this).select2(t)}))}},cityToInput:function(t){if(t.is("input"))t.prop("disabled",!1);else{var e=t.attr("name"),n=t.attr("id"),c=t.attr("placeholder");c=c||"",t.parent().find(".select2-container").remove(),t.replaceWith('<input type="text" class="input-text" name="'+e+'" id="'+n+'" placeholder="'+c+'" />')}},disableCity:function(t){t.val("").change(),t.prop("disabled",!0)},cityToSelect:function(t,e,n){var c=t.val();if(n=n?"district":"city",t.is("input")){var i=t.attr("name"),a=t.attr("id"),o=t.attr("placeholder");o=o||"",t.replaceWith('<select name="'+i+'" id="'+a+'" class="'+n+'_select" placeholder="'+o+'"></select>'),t=jQuery("#"+a)}else t.prop("disabled",!1);var r="";for(var s in e)if(e.hasOwnProperty(s)){var l=Array.isArray(e[s])?s:e[s];r=r+'<option value="'+l+'">'+l+"</option>"}t.html('<option value="">'+wc_cities_select_params.i18n_select_city_text+"</option>"+r),jQuery('option[value="'+c+'"]',t).length?t.val(c).change():t.val("").change(),this.$body.trigger(n+"_to_select")},getEnhancedSelectFormatString:function(){return{formatMatches:function(t){return 1===t?wc_country_select_params.i18n_matches_1:wc_country_select_params.i18n_matches_n.replace("%qty%",t)},formatNoMatches:function(){return wc_country_select_params.i18n_no_matches},formatAjaxError:function(){return wc_country_select_params.i18n_ajax_error},formatInputTooShort:function(t,e){var n=e-t.length;return 1===n?wc_country_select_params.i18n_input_too_short_1:wc_country_select_params.i18n_input_too_short_n.replace("%qty%",n)},formatInputTooLong:function(t,e){var n=t.length-e;return 1===n?wc_country_select_params.i18n_input_too_long_1:wc_country_select_params.i18n_input_too_long_n.replace("%qty%",n)},formatSelectionTooBig:function(t){return 1===t?wc_country_select_params.i18n_selection_too_long_1:wc_country_select_params.i18n_selection_too_long_n.replace("%qty%",t)},formatLoadMore:function(){return wc_country_select_params.i18n_load_more},formatSearching:function(){return wc_country_select_params.i18n_searching}}}},jQuery((function(e){new t}))}));
